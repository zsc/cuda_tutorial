# CUDA 高性能编程实战教程

## 关于本教程

本教程面向经验丰富的程序员和AI科学家，深入探讨CUDA编程的高级优化技术。通过自动驾驶和具身智能的实际案例，你将掌握从底层硬件优化到高层抽象框架的全方位技能。

### 学习目标
- 掌握CUDA内存层次结构与优化策略
- 精通warp级编程与协作组技术
- 理解并应用高级优化技巧（bank conflict规避、向量化访存、PTX内联等）
- 熟练使用CUTLASS等高性能库
- 在真实AI场景中实现10x-100x的性能提升

### 先修要求
- 熟练的C++编程能力
- 基础的并行计算概念
- 线性代数基础
- 对深度学习有基本了解

## 目录

### 第一部分：基础架构与编程模型

#### [第1章：CUDA硬件架构深度剖析](chapter1.md)
- GPU架构演进：从Volta到Hopper
- SM（流多处理器）内部结构
- Warp调度机制与占用率分析
- 内存层次结构概览
- 性能分析工具链（Nsight Compute/Systems）

#### [第2章：CUDA编程模型与执行模型](chapter2.md)
- 线程层次结构与网格配置
- 内核启动与动态并行
- 流与事件机制
- 统一内存与虚拟内存管理
- 错误处理与调试技术

### 第二部分：内存优化与数据移动

#### [第3章：全局内存优化策略](chapter3.md)
- 内存合并访问模式
- 缓存行为与配置
- 向量化load/store操作
- 内存带宽优化
- 案例：高带宽矩阵转置

#### [第4章：共享内存与Bank Conflict](chapter4.md)
- 共享内存架构详解
- Bank conflict的本质与检测
- 规避策略：padding、swizzling、permutation
- 双缓冲与流水线技术
- 案例：高性能矩阵乘法的共享内存优化

#### [第5章：寄存器优化与常量内存](chapter5.md)
- 寄存器分配与压力分析
- 寄存器重用与别名技术
- 常量内存与纹理内存使用
- 联合体与位操作优化
- 案例：寄存器级的卷积优化

### 第三部分：线程协作与同步

#### [第6章：Warp级编程与协作组](chapter6.md)
- Warp内在函数（shuffle、vote、match）
- 协作组（Cooperative Groups）编程
- Warp级归约与扫描算法
- 独立线程调度（Independent Thread Scheduling）
- 案例：无锁数据结构实现

#### [第7章：原子操作与同步原语](chapter7.md)
- 原子操作的硬件实现
- 自定义原子操作
- 内存栅栏与一致性模型
- 自旋锁与无锁算法
- 案例：高并发哈希表实现

### 第四部分：高级优化技术

#### [第8章：PTX内联与底层优化](chapter8.md)
- PTX汇编语言基础
- 内联PTX的使用场景
- 特殊寄存器访问
- 自定义浮点运算
- 案例：超低延迟的特殊函数实现

#### [第9章：张量核心与混合精度计算](chapter9.md)
- Tensor Core架构与编程
- WMMA API详解
- 混合精度训练策略
- 数值稳定性保证
- 案例：Transformer模型的张量核心加速

#### [第10章：CUTLASS深度解析](chapter10.md)
- CUTLASS架构与抽象层次
- 自定义GEMM内核
- Epilogue融合优化
- 布局转换与数据移动
- 案例：定制化的卷积算子实现

### 第五部分：自动驾驶场景案例

#### [第11章：激光雷达点云处理加速](chapter11.md)
- 点云数据结构与特征
- KD-Tree/Octree并行构建
- 最近邻搜索优化
- 点云配准算法（ICP/NDT）
- 实时3D目标检测（PointPillars/CenterPoint）

#### [第12章：多传感器融合的并行化](chapter12.md)
- 相机-激光雷达标定与融合
- 时间同步与数据关联
- 并行粒子滤波器
- GPU加速的卡尔曼滤波
- BEV（鸟瞰图）特征提取与融合

#### [第13章：实时语义分割与实例分割](chapter13.md)
- 高分辨率图像的分块处理
- 深度可分离卷积优化
- NMS（非极大值抑制）并行化
- Mask生成与后处理
- 多尺度特征融合策略

#### [第14章：路径规划与轨迹优化](chapter14.md)
- A*与RRT*的GPU并行化
- 批量轨迹采样与评估
- 动态规划的并行实现
- 二次规划求解器
- 实时避障与轨迹平滑

### 第六部分：具身智能场景案例

#### [第15章：视觉SLAM的GPU加速](chapter15.md)
- 特征提取与匹配（ORB/SuperPoint）
- 光束平差法（Bundle Adjustment）并行化
- 位姿图优化
- 稠密建图与TSDF融合
- 回环检测加速

#### [第16章：机械臂运动规划](chapter16.md)
- 正逆运动学并行求解
- 碰撞检测的空间哈希
- RRT-Connect的GPU实现
- 轨迹优化（CHOMP/TrajOpt）
- 多机械臂协调控制

#### [第17章：强化学习推理加速](chapter17.md)
- 批量环境仿真
- 神经网络推理优化
- 蒙特卡洛树搜索并行化
- 经验回放缓冲区管理
- PPO/SAC算法的GPU实现

#### [第18章：大规模点云重建与网格化](chapter18.md)
- Poisson重建的GPU加速
- Marching Cubes并行化
- 网格简化与优化
- 纹理映射与混合
- LOD（细节层次）生成

### 第七部分：系统级优化与部署

#### [第19章：多GPU编程与扩展](chapter19.md)
- NCCL通信原语
- 数据并行与模型并行
- Pipeline并行策略
- 异构系统优化
- 案例：分布式训练系统

#### [第20章：CUDA Graph与内核融合](chapter20.md)
- CUDA Graph构建与优化
- 内核融合策略
- 自动调优框架
- JIT编译优化
- 案例：端到端推理优化

#### [第21章：嵌入式GPU开发（Jetson）](chapter21.md)
- Jetson架构特点
- 功耗优化策略
- 统一内存的最佳实践
- TensorRT集成
- 案例：边缘AI部署

### 第八部分：前沿技术与未来展望

#### [第22章：稀疏计算与动态稀疏](chapter22.md)
- 稀疏矩阵格式（CSR/COO/ELL）
- cuSPARSE高级用法
- 2:4结构化稀疏
- 动态稀疏网络
- 案例：稀疏Transformer加速

#### [第23章：量化与低精度计算](chapter23.md)
- INT8/INT4量化技术
- 量化感知训练
- 动态量化策略
- 自定义量化算子
- 案例：超低比特推理

#### [第24章：新一代GPU特性展望](chapter24.md)
- Hopper架构新特性
- 异步执行与TMA
- 分布式共享内存
- 可编程的L2缓存
- 未来技术趋势

### 第九部分：调试、优化与工程实践

#### [第25章：性能分析与调优方法论](chapter25.md)
- 性能瓶颈识别流程
- Roofline模型分析
- 内存访问模式优化
- 占用率与寄存器平衡
- 指令级并行优化
- 案例：从10x到100x的优化历程

#### [第26章：CUDA调试技术与错误处理](chapter26.md)
- cuda-gdb与cuda-memcheck使用
- 竞态条件检测与修复
- 死锁分析与预防
- 内存错误定位（越界、泄漏）
- 数值精度问题调试
- 案例：复杂系统的调试实战

#### [第27章：开发环境与工具链配置](chapter27.md)
- CUDA工具链深度配置
- nvcc编译选项优化
- CMake与构建系统集成
- Nsight全家族工具精通
- CI/CD流水线搭建
- 案例：大型项目的工程化实践

## 附录

### [附录：参考资源与进阶阅读](appendix.md)
- 官方文档索引
- 学术论文推荐
- 开源项目分析
- 社区资源汇总

## 如何使用本教程

1. **循序渐进**：建议按章节顺序学习基础部分（第1-10章）
2. **案例驱动**：根据你的应用场景，选择相关案例深入学习
3. **动手实践**：每章的练习题都经过精心设计，请务必完成
4. **性能对比**：使用提供的基准测试代码，验证优化效果
5. **查阅附录**：遇到问题时，附录提供了丰富的排查资源

## 代码仓库

所有示例代码、练习题答案和基准测试程序都在配套的GitHub仓库中：
```
https://github.com/your-repo/cuda-tutorial
```

## 版本更新

- v1.0 (2024.01): 初始版本发布
- v1.1 (2024.06): 添加Hopper架构支持，更新CUTLASS 3.0内容
- v1.2 (2024.12): 新增具身智能案例，优化练习题设计

## 作者与贡献

本教程由CUDA社区共同维护，欢迎提交Issue和Pull Request。

## 版权声明

本教程采用 CC BY-NC-SA 4.0 协议发布。

---

准备好开启CUDA高性能编程之旅了吗？让我们从[第1章](chapter1.md)开始！